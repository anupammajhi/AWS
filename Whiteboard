# Install AWS Tools for PowerShell if not already installed
# Install-Module -Name AWSPowerShell -Force -AllowClobber

# Configure AWS credentials
# Set-AWSCredentials -AccessKey <YourAccessKey> -SecretKey <YourSecretKey> -StoreAs MyProfile

# Specify the AWS account ID
$accountId = "<your-account-id>"

# List all applied and inherited SCPs for the specified account
Get-AWSPolicy -ScopeLocal -PolicyType SERVICE_CONTROL_POLICY | ForEach-Object {
    $policyId = $_.PolicyId
    $policyName = $_.PolicyName

    # Check if the policy is attached to the account
    $isAttached = Get-AWSPolicyAttachment -PolicyId $policyId -TargetId $accountId -Recursive

    if ($isAttached) {
        Write-Output "Policy '$policyName' (ID: $policyId) is applied to the account."
    }
}